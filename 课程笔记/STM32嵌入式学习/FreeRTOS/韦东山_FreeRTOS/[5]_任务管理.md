## 任务管理

参考《FreeRTOS入门与工程实践(基于DshanMCU-103)》里《第9章  任务管理》



## 1. 创建任务_声光色影

配套源码：05_create_task

使用动态、静态分配内存的方式，分别创建多个任务：

* 声：使用无源蜂鸣器播放音乐

  ```shell
  参考:
  【用单片机吟唱孤勇者(STM32+无源蜂鸣器）】 
  https://github.com/Lesterbor/Embcode
  https://www.bilibili.com/video/BV1TF411p78W
  ```

* 光：LED闪烁

* 色：全彩LED渐变颜色

* 影：监测遥控器并在LCD上显示（甚至可以在LCD上播放动画，但是这个太耗费时间，不是RTOS课程的重点）



提问：如何确定栈的大小？



## 2. 创建任务_使用任务参数

配套源码：06_create_task_use_params

我们创建3个任务，使用同一个函数，但是在LCD上打印不一样的信息。



提问：如何互斥地访问LCD？使用全局变量，大概率可以，但是不是万无一失。

提问：为何是后面创建的task3先运行？



## 3. 删除任务_用遥控器控制音乐

代码为：07_delete_task

功能为：

* 当监测到遥控器的播放按键被按下后，创建音乐播放任务。
* 当监测到遥控器的Power按键被按下后，删除音乐播放任务。



提问：频繁地创建、删除任务，好吗？有什么坏处？如何解决？



## 4. 改善播放效果_优先级与阻塞

代码为：08_task_priority

本程序会：提高音乐播放任务的优先级，使用vTaskDelay进行延时。



## 5. 任务状态,任务管理与调度理论讲解(最重要的一节)

代码为：08_task_priority

重点：使用链表讲解内部原理。

* 任务状态：09_task_suspend，添加音乐暂停/恢复功能
* 优先级、链表管理、任务切换、tick
* 空闲任务：10_idle_task



## 6. 两个Delay函数

在06_create_task_use_params的基础上修改，得到11_task_delay







